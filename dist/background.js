(()=>{"use strict";class e{static async getVisibleText(e,r){try{const t=e?[{id:e}]:await chrome.tabs.query({active:!0,currentWindow:!0});if(!t||0===t.length||!t[0].id)throw new Error("No active tab found");const o=e=>{try{let r=null;if(r=e?document.querySelector(e):document.querySelector("main")||document.querySelector("#main-content")||document.querySelector(".scaffold-layout__main")||document.querySelector(".application-outlet")||document.body,!r)return console.log("No root element found"),"";const t=r.innerText||r.textContent||"";if(!t)return console.log("No text found in root element"),"";const o=t.replace(/\n{3,}/g,"\n\n").replace(/[ \t]{2,}/g," ").replace(/\s+\n/g,"\n").trim();return console.log(`Extracted ${o.length} characters`),o}catch(e){return console.error("Error in extractTextFromDOM:",e),""}},n=await chrome.scripting.executeScript({target:{tabId:t[0].id},func:o,args:r?[r]:[]});return n&&n[0]&&n[0].result||""}catch(e){throw console.error("Error extracting DOM content:",e),e}}}const r="openai_api_key";class t{static async saveApiKey(e){try{await chrome.storage.local.set({[r]:e}),console.log("API key saved successfully")}catch(e){throw console.error("Error saving API key:",e),new Error("Failed to save API key")}}static async getApiKey(){try{const e=(await chrome.storage.local.get(r))[r];return"string"==typeof e?e:null}catch(e){throw console.error("Error retrieving API key:",e),new Error("Failed to retrieve API key")}}static async clearApiKey(){try{await chrome.storage.local.remove(r),console.log("API key cleared successfully")}catch(e){throw console.error("Error clearing API key:",e),new Error("Failed to clear API key")}}static async hasApiKey(){const e=await this.getApiKey();return null!==e&&e.length>0}}const o={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let n;const s=new Uint8Array(16),a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function c(e,r,t){const o=(e=e||{}).random??e.rng?.()??function(){if(!n){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");n=crypto.getRandomValues.bind(crypto)}return n(s)}();if(o.length<16)throw new Error("Random bytes length must be >= 16");if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,r){if((t=t||0)<0||t+16>r.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let e=0;e<16;++e)r[t+e]=o[e];return r}return function(e,r=0){return(a[e[r+0]]+a[e[r+1]]+a[e[r+2]]+a[e[r+3]]+"-"+a[e[r+4]]+a[e[r+5]]+"-"+a[e[r+6]]+a[e[r+7]]+"-"+a[e[r+8]]+a[e[r+9]]+"-"+a[e[r+10]]+a[e[r+11]]+a[e[r+12]]+a[e[r+13]]+a[e[r+14]]+a[e[r+15]]).toLowerCase()}(o)}const i="profiles";class l{static async save(e){try{const s=await this.getAllAsMap(),a=e.id||(!o.randomUUID||t||r?c(r,t,n):o.randomUUID()),l=Date.now(),u={id:a,linkedinUrl:e.linkedinUrl||"",name:e.name||"",title:e.title||"",summary:e.summary||"",experience:e.experience||[],education:e.education||[],tags:e.tags||[],rawText:e.rawText||"",createdAt:e.createdAt||l};return s[a]=u,await chrome.storage.local.set({[i]:s}),console.log("Profile saved:",a),u}catch(e){throw console.error("Error saving profile:",e),new Error("Failed to save profile")}var r,t,n}static async getById(e){try{return(await this.getAllAsMap())[e]||null}catch(e){throw console.error("Error retrieving profile:",e),new Error("Failed to retrieve profile")}}static async getAll(){try{const e=await this.getAllAsMap(),r=Object.values(e);return r.sort((e,r)=>r.createdAt-e.createdAt),r}catch(e){throw console.error("Error retrieving all profiles:",e),new Error("Failed to retrieve profiles")}}static async delete(e){try{const r=await this.getAllAsMap();return!!r[e]&&(delete r[e],await chrome.storage.local.set({[i]:r}),console.log("Profile deleted:",e),!0)}catch(e){throw console.error("Error deleting profile:",e),new Error("Failed to delete profile")}}static async deleteAll(){try{await chrome.storage.local.set({[i]:{}}),console.log("All profiles deleted")}catch(e){throw console.error("Error deleting all profiles:",e),new Error("Failed to delete all profiles")}}static async getAllAsMap(){const e=(await chrome.storage.local.get(i))[i];return"object"==typeof e&&null!==e?e:{}}}class u{static async generateCompletion(e,r){const o=await t.getApiKey();if(!o)throw new Error("OpenAI API key not configured");const n={model:r?.model||"gpt-4o-mini",messages:e,temperature:r?.temperature??.7,max_tokens:r?.maxTokens||2e3};try{const e=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(n)});if(!e.ok){const r=await e.json().catch(()=>({}));throw new Error(`OpenAI API error: ${e.status} - ${r.error?.message||e.statusText}`)}const r=await e.json();if(!r.choices||0===r.choices.length)throw new Error("No completion returned from OpenAI");return{content:r.choices[0].message.content,usage:r.usage?{promptTokens:r.usage.prompt_tokens,completionTokens:r.usage.completion_tokens,totalTokens:r.usage.total_tokens}:void 0}}catch(e){if(console.error("Error calling OpenAI API:",e),e instanceof Error)throw e;throw new Error("Unknown error calling OpenAI API")}}static async generateStructuredData(e,r){const t=[{role:"system",content:"You are a helpful assistant that extracts structured data from text. Always respond with valid JSON only, no additional text or formatting."},{role:"user",content:e}],o=await this.generateCompletion(t,{...r,temperature:.3});try{const e=o.content.match(/\{[\s\S]*\}/),r=e?e[0]:o.content;return JSON.parse(r)}catch(e){throw console.error("Error parsing JSON response:",e),console.error("Raw response:",o.content),new Error("Failed to parse structured data from OpenAI response")}}static async extractProfileData(e){const r=`\nGiven the following text from a LinkedIn profile, extract and structure the following information:\n\n1. Person's full name\n2. Current job title\n3. A brief professional summary (2-3 sentences)\n4. List of work experience entries (company + role)\n5. List of education entries (institution + degree/field)\n6. Generate 5-10 relevant professional skill tags\n\nPlease format the output as a JSON object with these exact keys:\n- name (string)\n- title (string)\n- summary (string)\n- experience (array of strings)\n- education (array of strings)\n- tags (array of strings)\n\nLinkedIn Profile Text:\n${e}\n`;return this.generateStructuredData(r,{maxTokens:2e3})}static async searchProfiles(e,r){const t=`\nGiven the following search query and list of professional profiles, return the IDs of profiles that best match the query, ordered by relevance.\n\nSearch Query: "${e}"\n\nProfiles:\n${JSON.stringify(r,null,2)}\n\nPlease respond with a JSON array of profile IDs, ordered from most to least relevant. Only include profiles that are relevant to the query.\nFormat: ["id1", "id2", "id3", ...]\n`,o=await this.generateStructuredData(t);return Array.isArray(o)?o:[]}}const g="profile_queue";class d{static async enqueue(e){try{const r=await this.getQueue(),t=this.normalizeUrl(e);return r.includes(t)?(console.log("URL already in queue:",t),!1):(r.push(t),await chrome.storage.local.set({[g]:r}),console.log("URL added to queue:",t),!0)}catch(e){throw console.error("Error enqueueing URL:",e),new Error("Failed to enqueue URL")}}static async dequeue(){try{const e=await this.getQueue();if(0===e.length)return null;const r=e.shift();return await chrome.storage.local.set({[g]:e}),console.log("URL dequeued:",r),r}catch(e){throw console.error("Error dequeuing URL:",e),new Error("Failed to dequeue URL")}}static async getQueue(){try{const e=(await chrome.storage.local.get(g))[g];return Array.isArray(e)?e:[]}catch(e){throw console.error("Error getting queue:",e),new Error("Failed to get queue")}}static async clearQueue(){try{await chrome.storage.local.set({[g]:[]}),console.log("Queue cleared")}catch(e){throw console.error("Error clearing queue:",e),new Error("Failed to clear queue")}}static async getQueueSize(){return(await this.getQueue()).length}static async remove(e){try{const r=await this.getQueue(),t=this.normalizeUrl(e),o=r.length,n=r.filter(e=>e!==t);return n.length<o&&(await chrome.storage.local.set({[g]:n}),console.log("URL removed from queue:",t),!0)}catch(e){throw console.error("Error removing URL from queue:",e),new Error("Failed to remove URL from queue")}}static normalizeUrl(e){try{return`https://www.linkedin.com${new URL(e).pathname.replace(/\/$/,"")}`}catch{return e}}}class m{static async enrichProfile(r,t){try{if(!this.isValidLinkedInProfileUrl(r))return{success:!1,error:"Invalid LinkedIn profile URL"};let o,n;console.log("Extracting content from:",r);try{if(o=await e.getVisibleText(t),console.log(`Extracted ${o.length} characters from page`),!o||o.length<50)return console.log("Raw text sample:",o?o.substring(0,200):"none"),{success:!1,error:"Failed to extract sufficient content from page. Please ensure you are on a LinkedIn profile page."}}catch(e){return console.error("DOM extraction error:",e),{success:!1,error:`Failed to extract content from page: ${e instanceof Error?e.message:"Unknown error"}`}}console.log("Processing profile with AI...");try{n=await u.extractProfileData(o)}catch(e){return console.error("AI extraction error:",e),{success:!1,error:e instanceof Error?e.message:"Failed to process profile with AI"}}console.log("Saving profile...");const s={linkedinUrl:r,name:n.name||"Unknown",title:n.title||"",summary:n.summary||"",experience:n.experience||[],education:n.education||[],tags:n.tags||[],rawText:o.substring(0,5e3),createdAt:Date.now()},a=await l.save(s);return console.log("Profile enrichment completed:",a.id),{success:!0,profile:a}}catch(e){return console.error("Unexpected error during profile enrichment:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error during enrichment"}}}static async enrichMultipleProfiles(e){const r=[];for(const t of e){const o=await this.enrichProfile(t);r.push(o),r.length<e.length&&await new Promise(e=>setTimeout(e,1e3))}return r}static isValidLinkedInProfileUrl(e){try{const r=new URL(e);return("www.linkedin.com"===r.hostname||"linkedin.com"===r.hostname)&&r.pathname.startsWith("/in/")}catch{return!1}}}console.log("LinkedIn Profile Harvester background script loaded"),chrome.runtime.onMessage.addListener((r,o,n)=>(console.log("Received message:",r),(async()=>{switch(r.type){case"PING":return{success:!0,message:"pong"};case"EXTRACT_DOM_CONTENT":try{return{success:!0,text:await e.getVisibleText(r.tabId,r.selector)}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Unknown error"}}case"SAVE_API_KEY":try{return await t.saveApiKey(r.apiKey),{success:!0}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Unknown error"}}case"GET_API_KEY":try{return{success:!0,apiKey:await t.getApiKey()}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Unknown error"}}case"HAS_API_KEY":try{return{success:!0,hasKey:await t.hasApiKey()}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Unknown error"}}case"SAVE_PROFILE":try{return{success:!0,profile:await l.save(r.profile)}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Unknown error"}}case"GET_PROFILE":try{return{success:!0,profile:await l.getById(r.id)}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Unknown error"}}case"GET_ALL_PROFILES":try{return{success:!0,profiles:await l.getAll()}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Unknown error"}}case"DELETE_PROFILE":try{return{success:!0,deleted:await l.delete(r.id)}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Unknown error"}}case"ENQUEUE_PROFILE":try{return{success:!0,added:await d.enqueue(r.url)}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Unknown error"}}case"GET_QUEUE":try{return{success:!0,queue:await d.getQueue()}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Unknown error"}}case"ENRICH_PROFILE":try{return await m.enrichProfile(r.url,r.tabId)}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}case"SEARCH_PROFILES":try{const e=await l.getAll(),t=e.map(e=>({id:e.id,name:e.name,title:e.title,summary:e.summary,tags:e.tags}));return{success:!0,profiles:(await u.searchProfiles(r.query,t)).map(r=>e.find(e=>e.id===r)).filter(e=>void 0!==e)}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Unknown error"}}default:return{success:!1,message:"Unknown message type"}}})().then(n).catch(e=>{n({success:!1,message:e instanceof Error?e.message:"Unknown error"})}),!0)),chrome.runtime.onInstalled.addListener(e=>{console.log("Extension installed/updated:",e.reason)})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGFBQWlCZixNQUFRZSxFQUFNd0YsUUFBVSxnQkFFMUQsQ0FDSixRQUNJLE1BQU8sQ0FBRStDLFNBQVMsRUFBTy9DLFFBQVMsMEJBSTlDMEUsR0FDS0MsS0FBS1osR0FDTGpFLE1BQU10RixJQUNQdUosRUFBYSxDQUNUaEIsU0FBUyxFQUNUL0MsUUFBU3hGLGFBQWlCZixNQUFRZSxFQUFNd0YsUUFBVSxxQkFHbkQsSUFHWDVHLE9BQU9zSyxRQUFRa0IsWUFBWWhCLFlBQWFpQixJQUNwQzdLLFFBQVFDLElBQUksK0JBQWdDNEssRUFBUUMsUyIsInNvdXJjZXMiOlsid2VicGFjazovL0BqdXJpdGktbGFicy1sYWdvYS10ZWNoL2xpbmtlZGluLXByb2ZpbGUtaGFydmVzdGVyLy4vc3JjL3NlcnZpY2VzL0RvbUNvbnRlbnRFeHRyYWN0aW9uU2VydmljZS50cyIsIndlYnBhY2s6Ly9AanVyaXRpLWxhYnMtbGFnb2EtdGVjaC9saW5rZWRpbi1wcm9maWxlLWhhcnZlc3Rlci8uL3NyYy9zZXJ2aWNlcy9BaUludGVncmF0aW9uU2V0dGluZ3NTZXJ2aWNlLnRzIiwid2VicGFjazovL0BqdXJpdGktbGFicy1sYWdvYS10ZWNoL2xpbmtlZGluLXByb2ZpbGUtaGFydmVzdGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9uYXRpdmUuanMiLCJ3ZWJwYWNrOi8vQGp1cml0aS1sYWJzLWxhZ29hLXRlY2gvbGlua2VkaW4tcHJvZmlsZS1oYXJ2ZXN0ZXIvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L3JuZy5qcyIsIndlYnBhY2s6Ly9AanVyaXRpLWxhYnMtbGFnb2EtdGVjaC9saW5rZWRpbi1wcm9maWxlLWhhcnZlc3Rlci8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3Qvc3RyaW5naWZ5LmpzIiwid2VicGFjazovL0BqdXJpdGktbGFicy1sYWdvYS10ZWNoL2xpbmtlZGluLXByb2ZpbGUtaGFydmVzdGVyLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC92NC5qcyIsIndlYnBhY2s6Ly9AanVyaXRpLWxhYnMtbGFnb2EtdGVjaC9saW5rZWRpbi1wcm9maWxlLWhhcnZlc3Rlci8uL3NyYy9zZXJ2aWNlcy9Qcm9maWxlUmVwb3NpdG9yeS50cyIsIndlYnBhY2s6Ly9AanVyaXRpLWxhYnMtbGFnb2EtdGVjaC9saW5rZWRpbi1wcm9maWxlLWhhcnZlc3Rlci8uL3NyYy9zZXJ2aWNlcy9PcGVuQWlJbnRlZ3JhdGlvblNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vQGp1cml0aS1sYWJzLWxhZ29hLXRlY2gvbGlua2VkaW4tcHJvZmlsZS1oYXJ2ZXN0ZXIvLi9zcmMvc2VydmljZXMvUHJvZmlsZUVucXVldWVyU2VydmljZS50cyIsIndlYnBhY2s6Ly9AanVyaXRpLWxhYnMtbGFnb2EtdGVjaC9saW5rZWRpbi1wcm9maWxlLWhhcnZlc3Rlci8uL3NyYy9zZXJ2aWNlcy9BaVBvd2VyZWRQcm9maWxlRW5yaWNobWVudFNlcnZpY2UudHMiLCJ3ZWJwYWNrOi8vQGp1cml0aS1sYWJzLWxhZ29hLXRlY2gvbGlua2VkaW4tcHJvZmlsZS1oYXJ2ZXN0ZXIvLi9zcmMvYmFja2dyb3VuZC9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTZXJ2aWNlIGZvciBleHRyYWN0aW5nIGNvbnRlbnQgZnJvbSBET01cbmV4cG9ydCBjbGFzcyBEb21Db250ZW50RXh0cmFjdGlvblNlcnZpY2Uge1xuICAgIC8qKlxuICAgICAqIEV4dHJhY3RzIHZpc2libGUgdGV4dCBjb250ZW50IGZyb20gdGhlIHBhZ2VcbiAgICAgKiBAcGFyYW0gc2VsZWN0b3IgT3B0aW9uYWwgQ1NTIHNlbGVjdG9yIHRvIGxpbWl0IGV4dHJhY3Rpb24gc2NvcGVcbiAgICAgKiBAcmV0dXJucyBFeHRyYWN0ZWQgdGV4dCBjb250ZW50IGFzIHN0cmluZ1xuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBnZXRWaXNpYmxlVGV4dCh0YWJJZCwgc2VsZWN0b3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHRhYnMgPSB0YWJJZFxuICAgICAgICAgICAgICAgID8gW3sgaWQ6IHRhYklkIH1dXG4gICAgICAgICAgICAgICAgOiBhd2FpdCBjaHJvbWUudGFicy5xdWVyeSh7IGFjdGl2ZTogdHJ1ZSwgY3VycmVudFdpbmRvdzogdHJ1ZSB9KTtcbiAgICAgICAgICAgIGlmICghdGFicyB8fCB0YWJzLmxlbmd0aCA9PT0gMCB8fCAhdGFic1swXS5pZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYWN0aXZlIHRhYiBmb3VuZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRGVmaW5lIHRoZSBleHRyYWN0aW9uIGZ1bmN0aW9uIGlubGluZSB0byBhdm9pZCBzZXJpYWxpemF0aW9uIGlzc3Vlc1xuICAgICAgICAgICAgY29uc3QgZXh0cmFjdGlvbkZ1bmMgPSAoc2VsKSA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IHRvIGZpbmQgTGlua2VkSW4ncyBtYWluIGNvbnRlbnQgYXJlYSBvciB1c2Ugc2VsZWN0b3JcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJvb3QgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByb290ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IG11bHRpcGxlIHNlbGVjdG9ycyBmb3IgTGlua2VkSW5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtYWluJykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbWFpbi1jb250ZW50JykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2NhZmZvbGQtbGF5b3V0X19tYWluJykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXBwbGljYXRpb24tb3V0bGV0JykgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghcm9vdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ05vIHJvb3QgZWxlbWVudCBmb3VuZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSBpbm5lclRleHQgZm9yIHRoZSBzaW1wbGVzdCBhbmQgbW9zdCByZWxpYWJsZSBleHRyYWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSByb290LmlubmVyVGV4dCB8fCByb290LnRleHRDb250ZW50IHx8ICcnO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdObyB0ZXh0IGZvdW5kIGluIHJvb3QgZWxlbWVudCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIENsZWFuIHVwIHRoZSB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuZWRUZXh0ID0gdGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcbnszLH0vZywgJ1xcblxcbicpIC8vIE1heCAyIGNvbnNlY3V0aXZlIG5ld2xpbmVzXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvWyBcXHRdezIsfS9nLCAnICcpIC8vIE5vcm1hbGl6ZSBzcGFjZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXHMrXFxuL2csICdcXG4nKSAvLyBSZW1vdmUgdHJhaWxpbmcgc3BhY2VzIGJlZm9yZSBuZXdsaW5lc1xuICAgICAgICAgICAgICAgICAgICAgICAgLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEV4dHJhY3RlZCAke2NsZWFuZWRUZXh0Lmxlbmd0aH0gY2hhcmFjdGVyc2ApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xlYW5lZFRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBleHRyYWN0VGV4dEZyb21ET006JywgZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBjaHJvbWUuc2NyaXB0aW5nLmV4ZWN1dGVTY3JpcHQoe1xuICAgICAgICAgICAgICAgIHRhcmdldDogeyB0YWJJZDogdGFic1swXS5pZCB9LFxuICAgICAgICAgICAgICAgIGZ1bmM6IGV4dHJhY3Rpb25GdW5jLFxuICAgICAgICAgICAgICAgIGFyZ3M6IHNlbGVjdG9yID8gW3NlbGVjdG9yXSA6IFtdXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyZXN1bHRzICYmIHJlc3VsdHNbMF0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0c1swXS5yZXN1bHQgfHwgJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBleHRyYWN0aW5nIERPTSBjb250ZW50OicsIGVycm9yKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiLy8gU2VydmljZSBmb3IgbWFuYWdpbmcgQUkgaW50ZWdyYXRpb24gc2V0dGluZ3MgKE9wZW5BSSBBUEkga2V5KVxuY29uc3QgU1RPUkFHRV9LRVkgPSAnb3BlbmFpX2FwaV9rZXknO1xuZXhwb3J0IGNsYXNzIEFpSW50ZWdyYXRpb25TZXR0aW5nc1NlcnZpY2Uge1xuICAgIC8qKlxuICAgICAqIFNhdmVzIHRoZSBPcGVuQUkgQVBJIGtleSB0byBDaHJvbWUgc3RvcmFnZVxuICAgICAqIEBwYXJhbSBhcGlLZXkgVGhlIE9wZW5BSSBBUEkga2V5IHRvIHNhdmVcbiAgICAgKi9cbiAgICBzdGF0aWMgYXN5bmMgc2F2ZUFwaUtleShhcGlLZXkpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7IFtTVE9SQUdFX0tFWV06IGFwaUtleSB9KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBUEkga2V5IHNhdmVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2F2aW5nIEFQSSBrZXk6JywgZXJyb3IpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gc2F2ZSBBUEkga2V5Jyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIHRoZSBPcGVuQUkgQVBJIGtleSBmcm9tIENocm9tZSBzdG9yYWdlXG4gICAgICogQHJldHVybnMgVGhlIHN0b3JlZCBBUEkga2V5IG9yIG51bGwgaWYgbm90IHNldFxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBnZXRBcGlLZXkoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoU1RPUkFHRV9LRVkpO1xuICAgICAgICAgICAgY29uc3QgYXBpS2V5ID0gcmVzdWx0W1NUT1JBR0VfS0VZXTtcbiAgICAgICAgICAgIHJldHVybiB0eXBlb2YgYXBpS2V5ID09PSAnc3RyaW5nJyA/IGFwaUtleSA6IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZXRyaWV2aW5nIEFQSSBrZXk6JywgZXJyb3IpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gcmV0cmlldmUgQVBJIGtleScpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdGhlIEFQSSBrZXkgZnJvbSBzdG9yYWdlXG4gICAgICovXG4gICAgc3RhdGljIGFzeW5jIGNsZWFyQXBpS2V5KCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwucmVtb3ZlKFNUT1JBR0VfS0VZKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBUEkga2V5IGNsZWFyZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjbGVhcmluZyBBUEkga2V5OicsIGVycm9yKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGNsZWFyIEFQSSBrZXknKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYW4gQVBJIGtleSBpcyBjdXJyZW50bHkgc3RvcmVkXG4gICAgICogQHJldHVybnMgVHJ1ZSBpZiBhbiBBUEkga2V5IGV4aXN0cywgZmFsc2Ugb3RoZXJ3aXNlXG4gICAgICovXG4gICAgc3RhdGljIGFzeW5jIGhhc0FwaUtleSgpIHtcbiAgICAgICAgY29uc3QgYXBpS2V5ID0gYXdhaXQgdGhpcy5nZXRBcGlLZXkoKTtcbiAgICAgICAgcmV0dXJuIGFwaUtleSAhPT0gbnVsbCAmJiBhcGlLZXkubGVuZ3RoID4gMDtcbiAgICB9XG59XG4iLCJjb25zdCByYW5kb21VVUlEID0gdHlwZW9mIGNyeXB0byAhPT0gJ3VuZGVmaW5lZCcgJiYgY3J5cHRvLnJhbmRvbVVVSUQgJiYgY3J5cHRvLnJhbmRvbVVVSUQuYmluZChjcnlwdG8pO1xuZXhwb3J0IGRlZmF1bHQgeyByYW5kb21VVUlEIH07XG4iLCJsZXQgZ2V0UmFuZG9tVmFsdWVzO1xuY29uc3Qgcm5kczggPSBuZXcgVWludDhBcnJheSgxNik7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBybmcoKSB7XG4gICAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBjcnlwdG8gPT09ICd1bmRlZmluZWQnIHx8ICFjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NyeXB0by5nZXRSYW5kb21WYWx1ZXMoKSBub3Qgc3VwcG9ydGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkI2dldHJhbmRvbXZhbHVlcy1ub3Qtc3VwcG9ydGVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgZ2V0UmFuZG9tVmFsdWVzID0gY3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKGNyeXB0byk7XG4gICAgfVxuICAgIHJldHVybiBnZXRSYW5kb21WYWx1ZXMocm5kczgpO1xufVxuIiwiaW1wb3J0IHZhbGlkYXRlIGZyb20gJy4vdmFsaWRhdGUuanMnO1xuY29uc3QgYnl0ZVRvSGV4ID0gW107XG5mb3IgKGxldCBpID0gMDsgaSA8IDI1NjsgKytpKSB7XG4gICAgYnl0ZVRvSGV4LnB1c2goKGkgKyAweDEwMCkudG9TdHJpbmcoMTYpLnNsaWNlKDEpKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQgPSAwKSB7XG4gICAgcmV0dXJuIChieXRlVG9IZXhbYXJyW29mZnNldCArIDBdXSArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMV1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAyXV0gK1xuICAgICAgICBieXRlVG9IZXhbYXJyW29mZnNldCArIDNdXSArXG4gICAgICAgICctJyArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNF1dICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA1XV0gK1xuICAgICAgICAnLScgK1xuICAgICAgICBieXRlVG9IZXhbYXJyW29mZnNldCArIDZdXSArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgN11dICtcbiAgICAgICAgJy0nICtcbiAgICAgICAgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA4XV0gK1xuICAgICAgICBieXRlVG9IZXhbYXJyW29mZnNldCArIDldXSArXG4gICAgICAgICctJyArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTBdXSArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTFdXSArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTJdXSArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTNdXSArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTRdXSArXG4gICAgICAgIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTVdXSkudG9Mb3dlckNhc2UoKTtcbn1cbmZ1bmN0aW9uIHN0cmluZ2lmeShhcnIsIG9mZnNldCA9IDApIHtcbiAgICBjb25zdCB1dWlkID0gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0KTtcbiAgICBpZiAoIXZhbGlkYXRlKHV1aWQpKSB7XG4gICAgICAgIHRocm93IFR5cGVFcnJvcignU3RyaW5naWZpZWQgVVVJRCBpcyBpbnZhbGlkJyk7XG4gICAgfVxuICAgIHJldHVybiB1dWlkO1xufVxuZXhwb3J0IGRlZmF1bHQgc3RyaW5naWZ5O1xuIiwiaW1wb3J0IG5hdGl2ZSBmcm9tICcuL25hdGl2ZS5qcyc7XG5pbXBvcnQgcm5nIGZyb20gJy4vcm5nLmpzJztcbmltcG9ydCB7IHVuc2FmZVN0cmluZ2lmeSB9IGZyb20gJy4vc3RyaW5naWZ5LmpzJztcbmZ1bmN0aW9uIF92NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICAgIGNvbnN0IHJuZHMgPSBvcHRpb25zLnJhbmRvbSA/PyBvcHRpb25zLnJuZz8uKCkgPz8gcm5nKCk7XG4gICAgaWYgKHJuZHMubGVuZ3RoIDwgMTYpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSYW5kb20gYnl0ZXMgbGVuZ3RoIG11c3QgYmUgPj0gMTYnKTtcbiAgICB9XG4gICAgcm5kc1s2XSA9IChybmRzWzZdICYgMHgwZikgfCAweDQwO1xuICAgIHJuZHNbOF0gPSAocm5kc1s4XSAmIDB4M2YpIHwgMHg4MDtcbiAgICBpZiAoYnVmKSB7XG4gICAgICAgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuICAgICAgICBpZiAob2Zmc2V0IDwgMCB8fCBvZmZzZXQgKyAxNiA+IGJ1Zi5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKGBVVUlEIGJ5dGUgcmFuZ2UgJHtvZmZzZXR9OiR7b2Zmc2V0ICsgMTV9IGlzIG91dCBvZiBidWZmZXIgYm91bmRzYCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICAgICAgICBidWZbb2Zmc2V0ICsgaV0gPSBybmRzW2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBidWY7XG4gICAgfVxuICAgIHJldHVybiB1bnNhZmVTdHJpbmdpZnkocm5kcyk7XG59XG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICAgIGlmIChuYXRpdmUucmFuZG9tVVVJRCAmJiAhYnVmICYmICFvcHRpb25zKSB7XG4gICAgICAgIHJldHVybiBuYXRpdmUucmFuZG9tVVVJRCgpO1xuICAgIH1cbiAgICByZXR1cm4gX3Y0KG9wdGlvbnMsIGJ1Ziwgb2Zmc2V0KTtcbn1cbmV4cG9ydCBkZWZhdWx0IHY0O1xuIiwiLy8gUmVwb3NpdG9yeSBmb3IgbWFuYWdpbmcgUHJvZmlsZSBlbnRpdGllcyBpbiBDaHJvbWUgc3RvcmFnZVxuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCc7XG5jb25zdCBTVE9SQUdFX0tFWSA9ICdwcm9maWxlcyc7XG5leHBvcnQgY2xhc3MgUHJvZmlsZVJlcG9zaXRvcnkge1xuICAgIC8qKlxuICAgICAqIFNhdmVzIGEgcHJvZmlsZSB0byBzdG9yYWdlIChjcmVhdGVzIG5ldyBvciB1cGRhdGVzIGV4aXN0aW5nKVxuICAgICAqIEBwYXJhbSBwcm9maWxlIFByb2ZpbGUgdG8gc2F2ZVxuICAgICAqIEByZXR1cm5zIFRoZSBzYXZlZCBwcm9maWxlIHdpdGggZ2VuZXJhdGVkIElEIGlmIG5ld1xuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBzYXZlKHByb2ZpbGUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHByb2ZpbGVzID0gYXdhaXQgdGhpcy5nZXRBbGxBc01hcCgpO1xuICAgICAgICAgICAgLy8gR2VuZXJhdGUgSUQgaWYgbm90IHByZXNlbnRcbiAgICAgICAgICAgIGNvbnN0IGlkID0gcHJvZmlsZS5pZCB8fCB1dWlkdjQoKTtcbiAgICAgICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgICAgICBjb25zdCBzYXZlZFByb2ZpbGUgPSB7XG4gICAgICAgICAgICAgICAgaWQsXG4gICAgICAgICAgICAgICAgbGlua2VkaW5Vcmw6IHByb2ZpbGUubGlua2VkaW5VcmwgfHwgJycsXG4gICAgICAgICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lIHx8ICcnLFxuICAgICAgICAgICAgICAgIHRpdGxlOiBwcm9maWxlLnRpdGxlIHx8ICcnLFxuICAgICAgICAgICAgICAgIHN1bW1hcnk6IHByb2ZpbGUuc3VtbWFyeSB8fCAnJyxcbiAgICAgICAgICAgICAgICBleHBlcmllbmNlOiBwcm9maWxlLmV4cGVyaWVuY2UgfHwgW10sXG4gICAgICAgICAgICAgICAgZWR1Y2F0aW9uOiBwcm9maWxlLmVkdWNhdGlvbiB8fCBbXSxcbiAgICAgICAgICAgICAgICB0YWdzOiBwcm9maWxlLnRhZ3MgfHwgW10sXG4gICAgICAgICAgICAgICAgcmF3VGV4dDogcHJvZmlsZS5yYXdUZXh0IHx8ICcnLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogcHJvZmlsZS5jcmVhdGVkQXQgfHwgbm93XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcHJvZmlsZXNbaWRdID0gc2F2ZWRQcm9maWxlO1xuICAgICAgICAgICAgYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHsgW1NUT1JBR0VfS0VZXTogcHJvZmlsZXMgfSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUHJvZmlsZSBzYXZlZDonLCBpZCk7XG4gICAgICAgICAgICByZXR1cm4gc2F2ZWRQcm9maWxlO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igc2F2aW5nIHByb2ZpbGU6JywgZXJyb3IpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gc2F2ZSBwcm9maWxlJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGEgcHJvZmlsZSBieSBJRFxuICAgICAqIEBwYXJhbSBpZCBQcm9maWxlIElEXG4gICAgICogQHJldHVybnMgVGhlIHByb2ZpbGUgb3IgbnVsbCBpZiBub3QgZm91bmRcbiAgICAgKi9cbiAgICBzdGF0aWMgYXN5bmMgZ2V0QnlJZChpZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcHJvZmlsZXMgPSBhd2FpdCB0aGlzLmdldEFsbEFzTWFwKCk7XG4gICAgICAgICAgICByZXR1cm4gcHJvZmlsZXNbaWRdIHx8IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZXRyaWV2aW5nIHByb2ZpbGU6JywgZXJyb3IpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gcmV0cmlldmUgcHJvZmlsZScpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyBhbGwgcHJvZmlsZXMsIHNvcnRlZCBieSBjcmVhdGlvbiBkYXRlIChuZXdlc3QgZmlyc3QpXG4gICAgICogQHJldHVybnMgQXJyYXkgb2YgYWxsIHByb2ZpbGVzXG4gICAgICovXG4gICAgc3RhdGljIGFzeW5jIGdldEFsbCgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHByb2ZpbGVzID0gYXdhaXQgdGhpcy5nZXRBbGxBc01hcCgpO1xuICAgICAgICAgICAgY29uc3QgcHJvZmlsZUFycmF5ID0gT2JqZWN0LnZhbHVlcyhwcm9maWxlcyk7XG4gICAgICAgICAgICAvLyBTb3J0IGJ5IGNyZWF0ZWRBdCBkZXNjZW5kaW5nIChuZXdlc3QgZmlyc3QpXG4gICAgICAgICAgICBwcm9maWxlQXJyYXkuc29ydCgoYSwgYikgPT4gYi5jcmVhdGVkQXQgLSBhLmNyZWF0ZWRBdCk7XG4gICAgICAgICAgICByZXR1cm4gcHJvZmlsZUFycmF5O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmV0cmlldmluZyBhbGwgcHJvZmlsZXM6JywgZXJyb3IpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gcmV0cmlldmUgcHJvZmlsZXMnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGVzIGEgcHJvZmlsZSBieSBJRFxuICAgICAqIEBwYXJhbSBpZCBQcm9maWxlIElEIHRvIGRlbGV0ZVxuICAgICAqIEByZXR1cm5zIFRydWUgaWYgZGVsZXRlZCwgZmFsc2UgaWYgbm90IGZvdW5kXG4gICAgICovXG4gICAgc3RhdGljIGFzeW5jIGRlbGV0ZShpZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcHJvZmlsZXMgPSBhd2FpdCB0aGlzLmdldEFsbEFzTWFwKCk7XG4gICAgICAgICAgICBpZiAoIXByb2ZpbGVzW2lkXSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRlbGV0ZSBwcm9maWxlc1tpZF07XG4gICAgICAgICAgICBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoeyBbU1RPUkFHRV9LRVldOiBwcm9maWxlcyB9KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQcm9maWxlIGRlbGV0ZWQ6JywgaWQpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBwcm9maWxlOicsIGVycm9yKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGRlbGV0ZSBwcm9maWxlJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlcyBhbGwgcHJvZmlsZXNcbiAgICAgKi9cbiAgICBzdGF0aWMgYXN5bmMgZGVsZXRlQWxsKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHsgW1NUT1JBR0VfS0VZXToge30gfSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnQWxsIHByb2ZpbGVzIGRlbGV0ZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlbGV0aW5nIGFsbCBwcm9maWxlczonLCBlcnJvcik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBkZWxldGUgYWxsIHByb2ZpbGVzJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogSW50ZXJuYWwgaGVscGVyIHRvIGdldCBwcm9maWxlcyBhcyBhIG1hcFxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBnZXRBbGxBc01hcCgpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuZ2V0KFNUT1JBR0VfS0VZKTtcbiAgICAgICAgY29uc3QgcHJvZmlsZXMgPSByZXN1bHRbU1RPUkFHRV9LRVldO1xuICAgICAgICBpZiAodHlwZW9mIHByb2ZpbGVzID09PSAnb2JqZWN0JyAmJiBwcm9maWxlcyAhPT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuIHByb2ZpbGVzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG59XG4iLCIvLyBTZXJ2aWNlIGZvciBpbnRlZ3JhdGluZyB3aXRoIE9wZW5BSSBBUElcbmltcG9ydCB7IEFpSW50ZWdyYXRpb25TZXR0aW5nc1NlcnZpY2UgfSBmcm9tICcuL0FpSW50ZWdyYXRpb25TZXR0aW5nc1NlcnZpY2UnO1xuY29uc3QgT1BFTkFJX0FQSV9VUkwgPSAnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9jaGF0L2NvbXBsZXRpb25zJztcbmNvbnN0IERFRkFVTFRfTU9ERUwgPSAnZ3B0LTRvLW1pbmknO1xuZXhwb3J0IGNsYXNzIE9wZW5BaUludGVncmF0aW9uU2VydmljZSB7XG4gICAgLyoqXG4gICAgICogR2VuZXJhdGVzIGEgY29tcGxldGlvbiBmcm9tIE9wZW5BSVxuICAgICAqIEBwYXJhbSBtZXNzYWdlcyBBcnJheSBvZiBtZXNzYWdlcyBmb3IgdGhlIGNvbnZlcnNhdGlvblxuICAgICAqIEBwYXJhbSBvcHRpb25zIE9wdGlvbmFsIGNvbmZpZ3VyYXRpb25cbiAgICAgKiBAcmV0dXJucyBUaGUgY29tcGxldGlvbiByZXNwb25zZVxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBnZW5lcmF0ZUNvbXBsZXRpb24obWVzc2FnZXMsIG9wdGlvbnMpIHtcbiAgICAgICAgY29uc3QgYXBpS2V5ID0gYXdhaXQgQWlJbnRlZ3JhdGlvblNldHRpbmdzU2VydmljZS5nZXRBcGlLZXkoKTtcbiAgICAgICAgaWYgKCFhcGlLZXkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXF1ZXN0Qm9keSA9IHtcbiAgICAgICAgICAgIG1vZGVsOiBvcHRpb25zPy5tb2RlbCB8fCBERUZBVUxUX01PREVMLFxuICAgICAgICAgICAgbWVzc2FnZXMsXG4gICAgICAgICAgICB0ZW1wZXJhdHVyZTogb3B0aW9ucz8udGVtcGVyYXR1cmUgPz8gMC43LFxuICAgICAgICAgICAgbWF4X3Rva2Vuczogb3B0aW9ucz8ubWF4VG9rZW5zIHx8IDIwMDBcbiAgICAgICAgfTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goT1BFTkFJX0FQSV9VUkwsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2FwaUtleX1gXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShyZXF1ZXN0Qm9keSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKS5jYXRjaCgoKSA9PiAoe30pKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE9wZW5BSSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAtICR7ZXJyb3JEYXRhLmVycm9yPy5tZXNzYWdlIHx8IHJlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgaWYgKCFkYXRhLmNob2ljZXMgfHwgZGF0YS5jaG9pY2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gY29tcGxldGlvbiByZXR1cm5lZCBmcm9tIE9wZW5BSScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjb250ZW50OiBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50LFxuICAgICAgICAgICAgICAgIHVzYWdlOiBkYXRhLnVzYWdlXG4gICAgICAgICAgICAgICAgICAgID8ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvbXB0VG9rZW5zOiBkYXRhLnVzYWdlLnByb21wdF90b2tlbnMsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0aW9uVG9rZW5zOiBkYXRhLnVzYWdlLmNvbXBsZXRpb25fdG9rZW5zLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxUb2tlbnM6IGRhdGEudXNhZ2UudG90YWxfdG9rZW5zXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgOiB1bmRlZmluZWRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjYWxsaW5nIE9wZW5BSSBBUEk6JywgZXJyb3IpO1xuICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5rbm93biBlcnJvciBjYWxsaW5nIE9wZW5BSSBBUEknKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZXMgc3RydWN0dXJlZCBkYXRhIGZyb20gYSBwcm9tcHQgKGV4cGVjdHMgSlNPTiByZXNwb25zZSlcbiAgICAgKiBAcGFyYW0gcHJvbXB0IFRoZSBwcm9tcHQgdG8gc2VuZFxuICAgICAqIEBwYXJhbSBvcHRpb25zIE9wdGlvbmFsIGNvbmZpZ3VyYXRpb25cbiAgICAgKiBAcmV0dXJucyBQYXJzZWQgSlNPTiByZXNwb25zZVxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBnZW5lcmF0ZVN0cnVjdHVyZWREYXRhKHByb21wdCwgb3B0aW9ucykge1xuICAgICAgICBjb25zdCBtZXNzYWdlcyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByb2xlOiAnc3lzdGVtJyxcbiAgICAgICAgICAgICAgICBjb250ZW50OiAnWW91IGFyZSBhIGhlbHBmdWwgYXNzaXN0YW50IHRoYXQgZXh0cmFjdHMgc3RydWN0dXJlZCBkYXRhIGZyb20gdGV4dC4gJyArXG4gICAgICAgICAgICAgICAgICAgICdBbHdheXMgcmVzcG9uZCB3aXRoIHZhbGlkIEpTT04gb25seSwgbm8gYWRkaXRpb25hbCB0ZXh0IG9yIGZvcm1hdHRpbmcuJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICByb2xlOiAndXNlcicsXG4gICAgICAgICAgICAgICAgY29udGVudDogcHJvbXB0XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUNvbXBsZXRpb24obWVzc2FnZXMsIHtcbiAgICAgICAgICAgIC4uLm9wdGlvbnMsXG4gICAgICAgICAgICB0ZW1wZXJhdHVyZTogMC4zIC8vIExvd2VyIHRlbXBlcmF0dXJlIGZvciBtb3JlIGNvbnNpc3RlbnQgSlNPTiBvdXRwdXRcbiAgICAgICAgfSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBUcnkgdG8gZXh0cmFjdCBKU09OIGZyb20gdGhlIHJlc3BvbnNlXG4gICAgICAgICAgICBjb25zdCBqc29uTWF0Y2ggPSByZXNwb25zZS5jb250ZW50Lm1hdGNoKC9cXHtbXFxzXFxTXSpcXH0vKTtcbiAgICAgICAgICAgIGNvbnN0IGpzb25TdHJpbmcgPSBqc29uTWF0Y2ggPyBqc29uTWF0Y2hbMF0gOiByZXNwb25zZS5jb250ZW50O1xuICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoanNvblN0cmluZyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwYXJzaW5nIEpTT04gcmVzcG9uc2U6JywgZXJyb3IpO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignUmF3IHJlc3BvbnNlOicsIHJlc3BvbnNlLmNvbnRlbnQpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gcGFyc2Ugc3RydWN0dXJlZCBkYXRhIGZyb20gT3BlbkFJIHJlc3BvbnNlJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRXh0cmFjdHMgcHJvZmlsZSBpbmZvcm1hdGlvbiBmcm9tIExpbmtlZEluIHRleHRcbiAgICAgKiBAcGFyYW0gcHJvZmlsZVRleHQgVGhlIHJhdyB0ZXh0IGZyb20gYSBMaW5rZWRJbiBwcm9maWxlXG4gICAgICogQHJldHVybnMgU3RydWN0dXJlZCBwcm9maWxlIGRhdGFcbiAgICAgKi9cbiAgICBzdGF0aWMgYXN5bmMgZXh0cmFjdFByb2ZpbGVEYXRhKHByb2ZpbGVUZXh0KSB7XG4gICAgICAgIGNvbnN0IHByb21wdCA9IGBcbkdpdmVuIHRoZSBmb2xsb3dpbmcgdGV4dCBmcm9tIGEgTGlua2VkSW4gcHJvZmlsZSwgZXh0cmFjdCBhbmQgc3RydWN0dXJlIHRoZSBmb2xsb3dpbmcgaW5mb3JtYXRpb246XG5cbjEuIFBlcnNvbidzIGZ1bGwgbmFtZVxuMi4gQ3VycmVudCBqb2IgdGl0bGVcbjMuIEEgYnJpZWYgcHJvZmVzc2lvbmFsIHN1bW1hcnkgKDItMyBzZW50ZW5jZXMpXG40LiBMaXN0IG9mIHdvcmsgZXhwZXJpZW5jZSBlbnRyaWVzIChjb21wYW55ICsgcm9sZSlcbjUuIExpc3Qgb2YgZWR1Y2F0aW9uIGVudHJpZXMgKGluc3RpdHV0aW9uICsgZGVncmVlL2ZpZWxkKVxuNi4gR2VuZXJhdGUgNS0xMCByZWxldmFudCBwcm9mZXNzaW9uYWwgc2tpbGwgdGFnc1xuXG5QbGVhc2UgZm9ybWF0IHRoZSBvdXRwdXQgYXMgYSBKU09OIG9iamVjdCB3aXRoIHRoZXNlIGV4YWN0IGtleXM6XG4tIG5hbWUgKHN0cmluZylcbi0gdGl0bGUgKHN0cmluZylcbi0gc3VtbWFyeSAoc3RyaW5nKVxuLSBleHBlcmllbmNlIChhcnJheSBvZiBzdHJpbmdzKVxuLSBlZHVjYXRpb24gKGFycmF5IG9mIHN0cmluZ3MpXG4tIHRhZ3MgKGFycmF5IG9mIHN0cmluZ3MpXG5cbkxpbmtlZEluIFByb2ZpbGUgVGV4dDpcbiR7cHJvZmlsZVRleHR9XG5gO1xuICAgICAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZVN0cnVjdHVyZWREYXRhKHByb21wdCwge1xuICAgICAgICAgICAgbWF4VG9rZW5zOiAyMDAwXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWFyY2hlcyBwcm9maWxlcyB1c2luZyBuYXR1cmFsIGxhbmd1YWdlIHF1ZXJ5XG4gICAgICogQHBhcmFtIHF1ZXJ5IFRoZSBzZWFyY2ggcXVlcnlcbiAgICAgKiBAcGFyYW0gcHJvZmlsZXMgQXJyYXkgb2YgcHJvZmlsZSBzdW1tYXJpZXNcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiBwcm9maWxlIElEcyBpbiBvcmRlciBvZiByZWxldmFuY2VcbiAgICAgKi9cbiAgICBzdGF0aWMgYXN5bmMgc2VhcmNoUHJvZmlsZXMocXVlcnksIHByb2ZpbGVzKSB7XG4gICAgICAgIGNvbnN0IHByb21wdCA9IGBcbkdpdmVuIHRoZSBmb2xsb3dpbmcgc2VhcmNoIHF1ZXJ5IGFuZCBsaXN0IG9mIHByb2Zlc3Npb25hbCBwcm9maWxlcywgcmV0dXJuIHRoZSBJRHMgb2YgcHJvZmlsZXMgdGhhdCBiZXN0IG1hdGNoIHRoZSBxdWVyeSwgb3JkZXJlZCBieSByZWxldmFuY2UuXG5cblNlYXJjaCBRdWVyeTogXCIke3F1ZXJ5fVwiXG5cblByb2ZpbGVzOlxuJHtKU09OLnN0cmluZ2lmeShwcm9maWxlcywgbnVsbCwgMil9XG5cblBsZWFzZSByZXNwb25kIHdpdGggYSBKU09OIGFycmF5IG9mIHByb2ZpbGUgSURzLCBvcmRlcmVkIGZyb20gbW9zdCB0byBsZWFzdCByZWxldmFudC4gT25seSBpbmNsdWRlIHByb2ZpbGVzIHRoYXQgYXJlIHJlbGV2YW50IHRvIHRoZSBxdWVyeS5cbkZvcm1hdDogW1wiaWQxXCIsIFwiaWQyXCIsIFwiaWQzXCIsIC4uLl1cbmA7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTdHJ1Y3R1cmVkRGF0YShwcm9tcHQpO1xuICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheShyZXN1bHQpID8gcmVzdWx0IDogW107XG4gICAgfVxufVxuIiwiLy8gU2VydmljZSBmb3IgbWFuYWdpbmcgYSBxdWV1ZSBvZiBwcm9maWxlIFVSTHMgdG8gYmUgcHJvY2Vzc2VkXG5jb25zdCBRVUVVRV9TVE9SQUdFX0tFWSA9ICdwcm9maWxlX3F1ZXVlJztcbmV4cG9ydCBjbGFzcyBQcm9maWxlRW5xdWV1ZXJTZXJ2aWNlIHtcbiAgICAvKipcbiAgICAgKiBBZGRzIGEgcHJvZmlsZSBVUkwgdG8gdGhlIHF1ZXVlXG4gICAgICogQHBhcmFtIHVybCBMaW5rZWRJbiBwcm9maWxlIFVSTFxuICAgICAqIEByZXR1cm5zIFRydWUgaWYgYWRkZWQsIGZhbHNlIGlmIGFscmVhZHkgaW4gcXVldWVcbiAgICAgKi9cbiAgICBzdGF0aWMgYXN5bmMgZW5xdWV1ZSh1cmwpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHF1ZXVlID0gYXdhaXQgdGhpcy5nZXRRdWV1ZSgpO1xuICAgICAgICAgICAgLy8gTm9ybWFsaXplIFVSTCBhbmQgY2hlY2sgZm9yIGR1cGxpY2F0ZXNcbiAgICAgICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRVcmwgPSB0aGlzLm5vcm1hbGl6ZVVybCh1cmwpO1xuICAgICAgICAgICAgaWYgKHF1ZXVlLmluY2x1ZGVzKG5vcm1hbGl6ZWRVcmwpKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VSTCBhbHJlYWR5IGluIHF1ZXVlOicsIG5vcm1hbGl6ZWRVcmwpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHF1ZXVlLnB1c2gobm9ybWFsaXplZFVybCk7XG4gICAgICAgICAgICBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoeyBbUVVFVUVfU1RPUkFHRV9LRVldOiBxdWV1ZSB9KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVUkwgYWRkZWQgdG8gcXVldWU6Jywgbm9ybWFsaXplZFVybCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGVucXVldWVpbmcgVVJMOicsIGVycm9yKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGVucXVldWUgVVJMJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhbmQgcmV0dXJucyB0aGUgbmV4dCBVUkwgZnJvbSB0aGUgcXVldWVcbiAgICAgKiBAcmV0dXJucyBUaGUgbmV4dCBVUkwgb3IgbnVsbCBpZiBxdWV1ZSBpcyBlbXB0eVxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBkZXF1ZXVlKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcXVldWUgPSBhd2FpdCB0aGlzLmdldFF1ZXVlKCk7XG4gICAgICAgICAgICBpZiAocXVldWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB1cmwgPSBxdWV1ZS5zaGlmdCgpO1xuICAgICAgICAgICAgYXdhaXQgY2hyb21lLnN0b3JhZ2UubG9jYWwuc2V0KHsgW1FVRVVFX1NUT1JBR0VfS0VZXTogcXVldWUgfSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnVVJMIGRlcXVldWVkOicsIHVybCk7XG4gICAgICAgICAgICByZXR1cm4gdXJsO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGVxdWV1aW5nIFVSTDonLCBlcnJvcik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBkZXF1ZXVlIFVSTCcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGN1cnJlbnQgcXVldWUgd2l0aG91dCBtb2RpZnlpbmcgaXRcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiBVUkxzIGluIHRoZSBxdWV1ZVxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBnZXRRdWV1ZSgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNocm9tZS5zdG9yYWdlLmxvY2FsLmdldChRVUVVRV9TVE9SQUdFX0tFWSk7XG4gICAgICAgICAgICBjb25zdCBxdWV1ZSA9IHJlc3VsdFtRVUVVRV9TVE9SQUdFX0tFWV07XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShxdWV1ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcXVldWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHF1ZXVlOicsIGVycm9yKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdldCBxdWV1ZScpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFycyB0aGUgZW50aXJlIHF1ZXVlXG4gICAgICovXG4gICAgc3RhdGljIGFzeW5jIGNsZWFyUXVldWUoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoeyBbUVVFVUVfU1RPUkFHRV9LRVldOiBbXSB9KTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdRdWV1ZSBjbGVhcmVkJyk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjbGVhcmluZyBxdWV1ZTonLCBlcnJvcik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBjbGVhciBxdWV1ZScpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIG51bWJlciBvZiBpdGVtcyBpbiB0aGUgcXVldWVcbiAgICAgKi9cbiAgICBzdGF0aWMgYXN5bmMgZ2V0UXVldWVTaXplKCkge1xuICAgICAgICBjb25zdCBxdWV1ZSA9IGF3YWl0IHRoaXMuZ2V0UXVldWUoKTtcbiAgICAgICAgcmV0dXJuIHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhIHNwZWNpZmljIFVSTCBmcm9tIHRoZSBxdWV1ZVxuICAgICAqIEBwYXJhbSB1cmwgVVJMIHRvIHJlbW92ZVxuICAgICAqIEByZXR1cm5zIFRydWUgaWYgcmVtb3ZlZCwgZmFsc2UgaWYgbm90IGZvdW5kXG4gICAgICovXG4gICAgc3RhdGljIGFzeW5jIHJlbW92ZSh1cmwpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHF1ZXVlID0gYXdhaXQgdGhpcy5nZXRRdWV1ZSgpO1xuICAgICAgICAgICAgY29uc3Qgbm9ybWFsaXplZFVybCA9IHRoaXMubm9ybWFsaXplVXJsKHVybCk7XG4gICAgICAgICAgICBjb25zdCBpbml0aWFsTGVuZ3RoID0gcXVldWUubGVuZ3RoO1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlZFF1ZXVlID0gcXVldWUuZmlsdGVyKGl0ZW0gPT4gaXRlbSAhPT0gbm9ybWFsaXplZFVybCk7XG4gICAgICAgICAgICBpZiAodXBkYXRlZFF1ZXVlLmxlbmd0aCA8IGluaXRpYWxMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCBjaHJvbWUuc3RvcmFnZS5sb2NhbC5zZXQoeyBbUVVFVUVfU1RPUkFHRV9LRVldOiB1cGRhdGVkUXVldWUgfSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1VSTCByZW1vdmVkIGZyb20gcXVldWU6Jywgbm9ybWFsaXplZFVybCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZW1vdmluZyBVUkwgZnJvbSBxdWV1ZTonLCBlcnJvcik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byByZW1vdmUgVVJMIGZyb20gcXVldWUnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBOb3JtYWxpemVzIGEgTGlua2VkSW4gVVJMIGZvciBjb25zaXN0ZW50IGNvbXBhcmlzb25cbiAgICAgKi9cbiAgICBzdGF0aWMgbm9ybWFsaXplVXJsKHVybCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdXJsT2JqID0gbmV3IFVSTCh1cmwpO1xuICAgICAgICAgICAgLy8gUmVtb3ZlIHRyYWlsaW5nIHNsYXNoZXMgYW5kIHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICAgICAgICAgIGxldCBwYXRobmFtZSA9IHVybE9iai5wYXRobmFtZS5yZXBsYWNlKC9cXC8kLywgJycpO1xuICAgICAgICAgICAgcmV0dXJuIGBodHRwczovL3d3dy5saW5rZWRpbi5jb20ke3BhdGhuYW1lfWA7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2gge1xuICAgICAgICAgICAgLy8gSWYgVVJMIHBhcnNpbmcgZmFpbHMsIHJldHVybiBhcy1pc1xuICAgICAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIi8vIFNlcnZpY2UgZm9yIGVucmljaGluZyBMaW5rZWRJbiBwcm9maWxlcyB3aXRoIEFJLWV4dHJhY3RlZCBkYXRhXG5pbXBvcnQgeyBEb21Db250ZW50RXh0cmFjdGlvblNlcnZpY2UgfSBmcm9tICcuL0RvbUNvbnRlbnRFeHRyYWN0aW9uU2VydmljZSc7XG5pbXBvcnQgeyBPcGVuQWlJbnRlZ3JhdGlvblNlcnZpY2UgfSBmcm9tICcuL09wZW5BaUludGVncmF0aW9uU2VydmljZSc7XG5pbXBvcnQgeyBQcm9maWxlUmVwb3NpdG9yeSB9IGZyb20gJy4vUHJvZmlsZVJlcG9zaXRvcnknO1xuZXhwb3J0IGNsYXNzIEFpUG93ZXJlZFByb2ZpbGVFbnJpY2htZW50U2VydmljZSB7XG4gICAgLyoqXG4gICAgICogRW5yaWNoZXMgYSBMaW5rZWRJbiBwcm9maWxlIGJ5IGV4dHJhY3RpbmcgY29udGVudCBhbmQgcHJvY2Vzc2luZyB3aXRoIEFJXG4gICAgICogQHBhcmFtIHVybCBMaW5rZWRJbiBwcm9maWxlIFVSTFxuICAgICAqIEBwYXJhbSB0YWJJZCBPcHRpb25hbCB0YWIgSUQgKGlmIG5vdCBwcm92aWRlZCwgdXNlcyBhY3RpdmUgdGFiKVxuICAgICAqIEByZXR1cm5zIFRoZSBlbnJpY2hlZCBhbmQgc2F2ZWQgcHJvZmlsZVxuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBlbnJpY2hQcm9maWxlKHVybCwgdGFiSWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFN0ZXAgMTogVmFsaWRhdGUgVVJMXG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNWYWxpZExpbmtlZEluUHJvZmlsZVVybCh1cmwpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBMaW5rZWRJbiBwcm9maWxlIFVSTCdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gU3RlcCAyOiBFeHRyYWN0IERPTSBjb250ZW50XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnRXh0cmFjdGluZyBjb250ZW50IGZyb206JywgdXJsKTtcbiAgICAgICAgICAgIGxldCByYXdUZXh0O1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByYXdUZXh0ID0gYXdhaXQgRG9tQ29udGVudEV4dHJhY3Rpb25TZXJ2aWNlLmdldFZpc2libGVUZXh0KHRhYklkKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgRXh0cmFjdGVkICR7cmF3VGV4dC5sZW5ndGh9IGNoYXJhY3RlcnMgZnJvbSBwYWdlYCk7XG4gICAgICAgICAgICAgICAgaWYgKCFyYXdUZXh0IHx8IHJhd1RleHQubGVuZ3RoIDwgNTApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1JhdyB0ZXh0IHNhbXBsZTonLCByYXdUZXh0ID8gcmF3VGV4dC5zdWJzdHJpbmcoMCwgMjAwKSA6ICdub25lJyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBgRmFpbGVkIHRvIGV4dHJhY3Qgc3VmZmljaWVudCBjb250ZW50IGZyb20gcGFnZS4gUGxlYXNlIGVuc3VyZSB5b3UgYXJlIG9uIGEgTGlua2VkSW4gcHJvZmlsZSBwYWdlLmBcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdET00gZXh0cmFjdGlvbiBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBgRmFpbGVkIHRvIGV4dHJhY3QgY29udGVudCBmcm9tIHBhZ2U6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBTdGVwIDM6IFVzZSBBSSB0byBleHRyYWN0IHN0cnVjdHVyZWQgZGF0YVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1Byb2Nlc3NpbmcgcHJvZmlsZSB3aXRoIEFJLi4uJyk7XG4gICAgICAgICAgICBsZXQgZXh0cmFjdGVkRGF0YTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZXh0cmFjdGVkRGF0YSA9IGF3YWl0IE9wZW5BaUludGVncmF0aW9uU2VydmljZS5leHRyYWN0UHJvZmlsZURhdGEocmF3VGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdBSSBleHRyYWN0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBwcm9jZXNzIHByb2ZpbGUgd2l0aCBBSSdcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gU3RlcCA0OiBDcmVhdGUgYW5kIHNhdmUgcHJvZmlsZVxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NhdmluZyBwcm9maWxlLi4uJyk7XG4gICAgICAgICAgICBjb25zdCBwcm9maWxlID0ge1xuICAgICAgICAgICAgICAgIGxpbmtlZGluVXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgbmFtZTogZXh0cmFjdGVkRGF0YS5uYW1lIHx8ICdVbmtub3duJyxcbiAgICAgICAgICAgICAgICB0aXRsZTogZXh0cmFjdGVkRGF0YS50aXRsZSB8fCAnJyxcbiAgICAgICAgICAgICAgICBzdW1tYXJ5OiBleHRyYWN0ZWREYXRhLnN1bW1hcnkgfHwgJycsXG4gICAgICAgICAgICAgICAgZXhwZXJpZW5jZTogZXh0cmFjdGVkRGF0YS5leHBlcmllbmNlIHx8IFtdLFxuICAgICAgICAgICAgICAgIGVkdWNhdGlvbjogZXh0cmFjdGVkRGF0YS5lZHVjYXRpb24gfHwgW10sXG4gICAgICAgICAgICAgICAgdGFnczogZXh0cmFjdGVkRGF0YS50YWdzIHx8IFtdLFxuICAgICAgICAgICAgICAgIHJhd1RleHQ6IHJhd1RleHQuc3Vic3RyaW5nKDAsIDUwMDApLCAvLyBMaW1pdCByYXcgdGV4dCBzdG9yYWdlXG4gICAgICAgICAgICAgICAgY3JlYXRlZEF0OiBEYXRlLm5vdygpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3Qgc2F2ZWRQcm9maWxlID0gYXdhaXQgUHJvZmlsZVJlcG9zaXRvcnkuc2F2ZShwcm9maWxlKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQcm9maWxlIGVucmljaG1lbnQgY29tcGxldGVkOicsIHNhdmVkUHJvZmlsZS5pZCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICAgICAgcHJvZmlsZTogc2F2ZWRQcm9maWxlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignVW5leHBlY3RlZCBlcnJvciBkdXJpbmcgcHJvZmlsZSBlbnJpY2htZW50OicsIGVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3IgZHVyaW5nIGVucmljaG1lbnQnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVucmljaGVzIG11bHRpcGxlIHByb2ZpbGVzIGZyb20gYSBxdWV1ZVxuICAgICAqIEBwYXJhbSB1cmxzIEFycmF5IG9mIExpbmtlZEluIHByb2ZpbGUgVVJMc1xuICAgICAqIEByZXR1cm5zIEFycmF5IG9mIGVucmljaG1lbnQgcmVzdWx0c1xuICAgICAqL1xuICAgIHN0YXRpYyBhc3luYyBlbnJpY2hNdWx0aXBsZVByb2ZpbGVzKHVybHMpIHtcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHVybCBvZiB1cmxzKSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmVucmljaFByb2ZpbGUodXJsKTtcbiAgICAgICAgICAgIHJlc3VsdHMucHVzaChyZXN1bHQpO1xuICAgICAgICAgICAgLy8gU21hbGwgZGVsYXkgYmV0d2VlbiBwcm9maWxlcyB0byBhdm9pZCByYXRlIGxpbWl0aW5nXG4gICAgICAgICAgICBpZiAocmVzdWx0cy5sZW5ndGggPCB1cmxzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFZhbGlkYXRlcyBpZiBhIFVSTCBpcyBhIExpbmtlZEluIHByb2ZpbGUgVVJMXG4gICAgICovXG4gICAgc3RhdGljIGlzVmFsaWRMaW5rZWRJblByb2ZpbGVVcmwodXJsKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCB1cmxPYmogPSBuZXcgVVJMKHVybCk7XG4gICAgICAgICAgICByZXR1cm4gKCh1cmxPYmouaG9zdG5hbWUgPT09ICd3d3cubGlua2VkaW4uY29tJyB8fCB1cmxPYmouaG9zdG5hbWUgPT09ICdsaW5rZWRpbi5jb20nKSAmJlxuICAgICAgICAgICAgICAgIHVybE9iai5wYXRobmFtZS5zdGFydHNXaXRoKCcvaW4vJykpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsIi8vIEJhY2tncm91bmQgc2VydmljZSB3b3JrZXIgZm9yIExpbmtlZEluIFByb2ZpbGUgSGFydmVzdGVyXG5pbXBvcnQgeyBEb21Db250ZW50RXh0cmFjdGlvblNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9Eb21Db250ZW50RXh0cmFjdGlvblNlcnZpY2UnO1xuaW1wb3J0IHsgQWlJbnRlZ3JhdGlvblNldHRpbmdzU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL0FpSW50ZWdyYXRpb25TZXR0aW5nc1NlcnZpY2UnO1xuaW1wb3J0IHsgUHJvZmlsZVJlcG9zaXRvcnkgfSBmcm9tICcuLi9zZXJ2aWNlcy9Qcm9maWxlUmVwb3NpdG9yeSc7XG5pbXBvcnQgeyBPcGVuQWlJbnRlZ3JhdGlvblNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9PcGVuQWlJbnRlZ3JhdGlvblNlcnZpY2UnO1xuaW1wb3J0IHsgUHJvZmlsZUVucXVldWVyU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL1Byb2ZpbGVFbnF1ZXVlclNlcnZpY2UnO1xuaW1wb3J0IHsgQWlQb3dlcmVkUHJvZmlsZUVucmljaG1lbnRTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvQWlQb3dlcmVkUHJvZmlsZUVucmljaG1lbnRTZXJ2aWNlJztcbmNvbnNvbGUubG9nKCdMaW5rZWRJbiBQcm9maWxlIEhhcnZlc3RlciBiYWNrZ3JvdW5kIHNjcmlwdCBsb2FkZWQnKTtcbi8vIExpc3RlbiBmb3IgbWVzc2FnZXMgZnJvbSBjb250ZW50IHNjcmlwdHMgYW5kIHBvcHVwXG5jaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoKHJlcXVlc3QsIHNlbmRlciwgc2VuZFJlc3BvbnNlKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ1JlY2VpdmVkIG1lc3NhZ2U6JywgcmVxdWVzdCk7XG4gICAgLy8gSGFuZGxlIGRpZmZlcmVudCBtZXNzYWdlIHR5cGVzXG4gICAgY29uc3QgaGFuZGxlTWVzc2FnZSA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgc3dpdGNoIChyZXF1ZXN0LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ1BJTkcnOlxuICAgICAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdwb25nJyB9O1xuICAgICAgICAgICAgY2FzZSAnRVhUUkFDVF9ET01fQ09OVEVOVCc6XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IERvbUNvbnRlbnRFeHRyYWN0aW9uU2VydmljZS5nZXRWaXNpYmxlVGV4dChyZXF1ZXN0LnRhYklkLCByZXF1ZXN0LnNlbGVjdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgdGV4dCB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdTQVZFX0FQSV9LRVknOlxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IEFpSW50ZWdyYXRpb25TZXR0aW5nc1NlcnZpY2Uuc2F2ZUFwaUtleShyZXF1ZXN0LmFwaUtleSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSAnR0VUX0FQSV9LRVknOlxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFwaUtleSA9IGF3YWl0IEFpSW50ZWdyYXRpb25TZXR0aW5nc1NlcnZpY2UuZ2V0QXBpS2V5KCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGFwaUtleSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdIQVNfQVBJX0tFWSc6XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaGFzS2V5ID0gYXdhaXQgQWlJbnRlZ3JhdGlvblNldHRpbmdzU2VydmljZS5oYXNBcGlLZXkoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgaGFzS2V5IH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgJ1NBVkVfUFJPRklMRSc6XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2F2ZWRQcm9maWxlID0gYXdhaXQgUHJvZmlsZVJlcG9zaXRvcnkuc2F2ZShyZXF1ZXN0LnByb2ZpbGUpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBwcm9maWxlOiBzYXZlZFByb2ZpbGUgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSAnR0VUX1BST0ZJTEUnOlxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb2ZpbGUgPSBhd2FpdCBQcm9maWxlUmVwb3NpdG9yeS5nZXRCeUlkKHJlcXVlc3QuaWQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBwcm9maWxlIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgJ0dFVF9BTExfUFJPRklMRVMnOlxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb2ZpbGVzID0gYXdhaXQgUHJvZmlsZVJlcG9zaXRvcnkuZ2V0QWxsKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHByb2ZpbGVzIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgJ0RFTEVURV9QUk9GSUxFJzpcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkZWxldGVkID0gYXdhaXQgUHJvZmlsZVJlcG9zaXRvcnkuZGVsZXRlKHJlcXVlc3QuaWQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkZWxldGVkIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgJ0VOUVVFVUVfUFJPRklMRSc6XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWRkZWQgPSBhd2FpdCBQcm9maWxlRW5xdWV1ZXJTZXJ2aWNlLmVucXVldWUocmVxdWVzdC51cmwpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBhZGRlZCB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdHRVRfUVVFVUUnOlxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHF1ZXVlID0gYXdhaXQgUHJvZmlsZUVucXVldWVyU2VydmljZS5nZXRRdWV1ZSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBxdWV1ZSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcidcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdFTlJJQ0hfUFJPRklMRSc6XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgQWlQb3dlcmVkUHJvZmlsZUVucmljaG1lbnRTZXJ2aWNlLmVucmljaFByb2ZpbGUocmVxdWVzdC51cmwsIHJlcXVlc3QudGFiSWQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSAnU0VBUkNIX1BST0ZJTEVTJzpcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9maWxlcyA9IGF3YWl0IFByb2ZpbGVSZXBvc2l0b3J5LmdldEFsbCgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdW1tYXJpZXMgPSBwcm9maWxlcy5tYXAocCA9PiAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHAuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBwLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogcC50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1bW1hcnk6IHAuc3VtbWFyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IHAudGFnc1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb2ZpbGVJZHMgPSBhd2FpdCBPcGVuQWlJbnRlZ3JhdGlvblNlcnZpY2Uuc2VhcmNoUHJvZmlsZXMocmVxdWVzdC5xdWVyeSwgc3VtbWFyaWVzKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hlZFByb2ZpbGVzID0gcHJvZmlsZUlkc1xuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChpZCA9PiBwcm9maWxlcy5maW5kKHAgPT4gcC5pZCA9PT0gaWQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihwID0+IHAgIT09IHVuZGVmaW5lZCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHByb2ZpbGVzOiBtYXRjaGVkUHJvZmlsZXMgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ1Vua25vd24gbWVzc2FnZSB0eXBlJyB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvLyBFeGVjdXRlIGFzeW5jIGhhbmRsZXIgYW5kIHNlbmQgcmVzcG9uc2VcbiAgICBoYW5kbGVNZXNzYWdlKClcbiAgICAgICAgLnRoZW4oc2VuZFJlc3BvbnNlKVxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICBzZW5kUmVzcG9uc2Uoe1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBtZXNzYWdlOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJ1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgICByZXR1cm4gdHJ1ZTsgLy8gS2VlcCB0aGUgbWVzc2FnZSBjaGFubmVsIG9wZW4gZm9yIGFzeW5jIHJlc3BvbnNlc1xufSk7XG4vLyBFeHRlbnNpb24gaW5zdGFsbGVkIG9yIHVwZGF0ZWRcbmNocm9tZS5ydW50aW1lLm9uSW5zdGFsbGVkLmFkZExpc3RlbmVyKChkZXRhaWxzKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ0V4dGVuc2lvbiBpbnN0YWxsZWQvdXBkYXRlZDonLCBkZXRhaWxzLnJlYXNvbik7XG59KTtcbiJdLCJuYW1lcyI6WyJEb21Db250ZW50RXh0cmFjdGlvblNlcnZpY2UiLCJnZXRWaXNpYmxlVGV4dCIsInRhYklkIiwic2VsZWN0b3IiLCJ0YWJzIiwiaWQiLCJjaHJvbWUiLCJxdWVyeSIsImFjdGl2ZSIsImN1cnJlbnRXaW5kb3ciLCJsZW5ndGgiLCJFcnJvciIsImV4dHJhY3Rpb25GdW5jIiwic2VsIiwicm9vdCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImJvZHkiLCJjb25zb2xlIiwibG9nIiwidGV4dCIsImlubmVyVGV4dCIsInRleHRDb250ZW50IiwiY2xlYW5lZFRleHQiLCJyZXBsYWNlIiwidHJpbSIsImVycm9yIiwicmVzdWx0cyIsInNjcmlwdGluZyIsImV4ZWN1dGVTY3JpcHQiLCJ0YXJnZXQiLCJmdW5jIiwiYXJncyIsInJlc3VsdCIsIlNUT1JBR0VfS0VZIiwiQWlJbnRlZ3JhdGlvblNldHRpbmdzU2VydmljZSIsInNhdmVBcGlLZXkiLCJhcGlLZXkiLCJzdG9yYWdlIiwibG9jYWwiLCJzZXQiLCJnZXRBcGlLZXkiLCJnZXQiLCJjbGVhckFwaUtleSIsInJlbW92ZSIsImhhc0FwaUtleSIsInRoaXMiLCJyYW5kb21VVUlEIiwiY3J5cHRvIiwiYmluZCIsImdldFJhbmRvbVZhbHVlcyIsInJuZHM4IiwiVWludDhBcnJheSIsImJ5dGVUb0hleCIsImkiLCJwdXNoIiwidG9TdHJpbmciLCJzbGljZSIsIl92NCIsIm9wdGlvbnMiLCJidWYiLCJvZmZzZXQiLCJybmRzIiwicmFuZG9tIiwicm5nIiwiUmFuZ2VFcnJvciIsImFyciIsInRvTG93ZXJDYXNlIiwidW5zYWZlU3RyaW5naWZ5IiwiUHJvZmlsZVJlcG9zaXRvcnkiLCJzYXZlIiwicHJvZmlsZSIsInByb2ZpbGVzIiwiZ2V0QWxsQXNNYXAiLCJub3ciLCJEYXRlIiwic2F2ZWRQcm9maWxlIiwibGlua2VkaW5VcmwiLCJuYW1lIiwidGl0bGUiLCJzdW1tYXJ5IiwiZXhwZXJpZW5jZSIsImVkdWNhdGlvbiIsInRhZ3MiLCJyYXdUZXh0IiwiY3JlYXRlZEF0IiwiZ2V0QnlJZCIsImdldEFsbCIsInByb2ZpbGVBcnJheSIsIk9iamVjdCIsInZhbHVlcyIsInNvcnQiLCJhIiwiYiIsImRlbGV0ZUFsbCIsIk9wZW5BaUludGVncmF0aW9uU2VydmljZSIsImdlbmVyYXRlQ29tcGxldGlvbiIsIm1lc3NhZ2VzIiwicmVxdWVzdEJvZHkiLCJtb2RlbCIsInRlbXBlcmF0dXJlIiwibWF4X3Rva2VucyIsIm1heFRva2VucyIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiSlNPTiIsInN0cmluZ2lmeSIsIm9rIiwiZXJyb3JEYXRhIiwianNvbiIsImNhdGNoIiwic3RhdHVzIiwibWVzc2FnZSIsInN0YXR1c1RleHQiLCJkYXRhIiwiY2hvaWNlcyIsImNvbnRlbnQiLCJ1c2FnZSIsInByb21wdFRva2VucyIsInByb21wdF90b2tlbnMiLCJjb21wbGV0aW9uVG9rZW5zIiwiY29tcGxldGlvbl90b2tlbnMiLCJ0b3RhbFRva2VucyIsInRvdGFsX3Rva2VucyIsInVuZGVmaW5lZCIsImdlbmVyYXRlU3RydWN0dXJlZERhdGEiLCJwcm9tcHQiLCJyb2xlIiwianNvbk1hdGNoIiwibWF0Y2giLCJqc29uU3RyaW5nIiwicGFyc2UiLCJleHRyYWN0UHJvZmlsZURhdGEiLCJwcm9maWxlVGV4dCIsInNlYXJjaFByb2ZpbGVzIiwiQXJyYXkiLCJpc0FycmF5IiwiUVVFVUVfU1RPUkFHRV9LRVkiLCJQcm9maWxlRW5xdWV1ZXJTZXJ2aWNlIiwiZW5xdWV1ZSIsInVybCIsInF1ZXVlIiwiZ2V0UXVldWUiLCJub3JtYWxpemVkVXJsIiwibm9ybWFsaXplVXJsIiwiaW5jbHVkZXMiLCJkZXF1ZXVlIiwic2hpZnQiLCJjbGVhclF1ZXVlIiwiZ2V0UXVldWVTaXplIiwiaW5pdGlhbExlbmd0aCIsInVwZGF0ZWRRdWV1ZSIsImZpbHRlciIsIml0ZW0iLCJVUkwiLCJwYXRobmFtZSIsIkFpUG93ZXJlZFByb2ZpbGVFbnJpY2htZW50U2VydmljZSIsImVucmljaFByb2ZpbGUiLCJpc1ZhbGlkTGlua2VkSW5Qcm9maWxlVXJsIiwic3VjY2VzcyIsImV4dHJhY3RlZERhdGEiLCJzdWJzdHJpbmciLCJlbnJpY2hNdWx0aXBsZVByb2ZpbGVzIiwidXJscyIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsInVybE9iaiIsImhvc3RuYW1lIiwic3RhcnRzV2l0aCIsInJ1bnRpbWUiLCJvbk1lc3NhZ2UiLCJhZGRMaXN0ZW5lciIsInJlcXVlc3QiLCJzZW5kZXIiLCJzZW5kUmVzcG9uc2UiLCJhc3luYyIsInR5cGUiLCJoYXNLZXkiLCJkZWxldGVkIiwiZGVsZXRlIiwiYWRkZWQiLCJzdW1tYXJpZXMiLCJtYXAiLCJwIiwiZmluZCIsImhhbmRsZU1lc3NhZ2UiLCJ0aGVuIiwib25JbnN0YWxsZWQiLCJkZXRhaWxzIiwicmVhc29uIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=